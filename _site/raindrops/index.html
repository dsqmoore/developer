<!DOCTYPE html>
<html class="no-js" dir="ltr" lang="en">
  <head>
    <title>CloudApp Developer - Raindrops</title>

    <meta charset="utf-8">

    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width = device-width, initial-scale = 1.0, maximum-scale = 1.0, minimum-scale = 1.0, user-scalable = no" name="viewport">

    <!--[if !IE 6]><!-->
    <link href="../stylesheets/screen.css" rel="stylesheet">
    <!--<![endif]-->

    <script src="../javascripts/jquery-1.4.3.min.js"></script>
    <script src="../javascripts/modernizr-1.6.min.js"></script>

    <!--[if IE 6]>
    <link href="http://universal-ie6-css.googlecode.com/files/ie6.0.3.css" rel="stylesheet">
    <![endif]-->

    <!--[if lt IE 9]>
    <script src="../javascripts/selectivizr-1.0.min.js"></script>
    <![endif]-->

    <script>
      $(document).ready(function() {
        $('#quicknav select').change(function() {
          window.location = $(this).val();
        });
      });
    </script>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-13203564-3']);
      _gaq.push(['_setDomainName', '.getcloudapp.com']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body>
    <div class="container">
      <header class="row" id="header">
        <div class="col col_4">
          <h1><a href="/">CloudApp Developer</a></h1>
        </div>

        <div class="col col_8">
          <nav>
            <ul>
              <li><a href="http://getcloudapp.com/">Application</a></li>
              <li><a href="http://blog.getcloud.me/">Blog</a></li>
              <li><a href="http://help.getcloud.me/">Support</a></li>
              <li><a href="http://my.cl.ly/">Login</a></li>
            </ul>
          </nav>
        </div>
      </header>

      <section class="row" id="quicknav">
        <select class="col col_12">
          <option value="/" >Welcome</option>

          
            <optgroup label="Basics">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/common-errors" >Common Errors</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/usage" >Usage</option>
                
              
                
              
                
              
                
              
                
              
            </optgroup>
          
            <optgroup label="Wrapper">
              
                
              
                
              
                
                  <option value="/c-sharp-wrapper" >C#</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/java-wrapper" >Java</option>
                
              
                
              
                
                  <option value="/objective-c-wrapper" >Objective-C</option>
                
              
                
                  <option value="/perl-wrapper" >Perl</option>
                
              
                
                  <option value="/php-wrapper" >PHP</option>
                
              
                
                  <option value="/python-wrapper" >Python</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/ruby-wrapper" >Ruby</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </optgroup>
          
            <optgroup label="Account">
              
                
              
                
              
                
              
                
                  <option value="/change-default-security" >Change Default Security</option>
                
              
                
                  <option value="/change-email" >Change Email</option>
                
              
                
                  <option value="/change-password" >Change Password</option>
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/forgot-password" >Forgot Password</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/register" >Register</option>
                
              
                
              
                
              
                
                  <option value="/set-custom-domain" >Set Custom Domain</option>
                
              
                
              
                
              
                
              
                
                  <option value="/view-account-details" >View Account Details</option>
                
              
                
                  <option value="/view-account-stats" >View Account Stats</option>
                
              
                
              
                
              
            </optgroup>
          
            <optgroup label="Items">
              
                
                  <option value="/bookmark-link" >Bookmark Link</option>
                
              
                
                  <option value="/bookmark-multiple-links" >Bookmark Multiple Links</option>
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/change-security-of-item" >Change Security Of Item</option>
                
              
                
              
                
                  <option value="/delete-item" >Delete Item</option>
                
              
                
                  <option value="/empty-trash" >Empty Trash</option>
                
              
                
              
                
              
                
                  <option value="/list-items" >List Items</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/recover-deleted-item" >Recover Deleted Item</option>
                
              
                
              
                
              
                
                  <option value="/rename-item" >Rename Item</option>
                
              
                
              
                
              
                
                  <option value="/streaming-items" >Stream Items</option>
                
              
                
                  <option value="/upload-file" >Upload File</option>
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/view-item" >View Item</option>
                
              
            </optgroup>
          
            <optgroup label="Gift cards">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/redeem-gift-card" >Redeem Gift Card</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/view-gift-card" >View Gift Card Details</option>
                
              
                
              
            </optgroup>
          
            <optgroup label="Mac">
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
                  <option value="/raindrops" selected>Raindrops</option>
                
              
                
                  <option value="/raindrops-metadata" >Raindrops Metadata</option>
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </optgroup>
          
        </select>
      </section>

      <div class="row">
        <section class="col col_8 wikistyle">
          <h1 id='raindrops'>Raindrops</h1>

<p>Raindrops are an essential part of the CloudApp ecosystem: they enable ways for the user to work with an application that may not fully work with the pasteboard. They are essentially plug ins that hook into CloudApp and allow you to respond to the Raindrop hotkey being triggered, in addition to being able to initiate file uploads.</p>

<h2 id='how_can_raindrops_be_used'>How can Raindrops be used?</h2>

<p>To give you an idea about how Raindrops can be used, and what functionality they can provide, two first-party Raindrops can be examined. The <a href='https://github.com/cloudapp/raindrops/tree/master/Photoshop'>Photoshop Raindrop</a> will allow the frontmost document in Photoshop to be uploaded to CloudApp when the Raindrop hotkey is pressed. Adobe applications do not write to the system pasteboard until the application becomes inactive. Therefore, copying a section of a document and hitting the clipboard hotkey will lead to unexpected results. A Raindrop, therefore, would make a lot of sense. Another place where a Raindrop would be useful is with auto-uploading of screenshots. Our <a href='https://github.com/cloudapp/raindrops/tree/master/Screenshots'>Screenshot Raindrop</a> will watch the user’s screen shot folder for new files, check them to see if they are screenshots, and then upload them if so.</p>

<h2 id='great_now_how_do_i_get_started'>Great! Now how do I get started?</h2>

<p>Raindrops are Cocoa bundles. You can create one by going to <em>File &gt; New &gt; New Project…</em> in Xcode and selecting the <em>Bundle</em> template from the <em>Framework &amp; Library</em> group. Make sure that your bundle uses the Cocoa framework.</p>

<p>Next, create a new file, subclass of <code>NSObject</code>. Add <code>CLRaindropProtocol.h</code> and <code>CLRaindropHelperProtocol.h</code> to your project, under Classes. <a href='https://github.com/cloudapp/raindrops'>You can find both files on github</a>. The class you just created must implement <code>CLRaindropProtocol</code>.</p>

<p>Now go into <code>Info.plist</code> and set the value of the <code>Principal Class</code> key to <code>MyClass</code>, or whatever you named the class you created in the previous step. Edit the build settings of your project to use <code>raindrop</code> as the <code>Wrapper Extension</code>.</p>

<p>Last but not least, add an empty Property List <code>Raindrop.plist</code> file to your project. Every Raindrop must define <a href='/raindrops-metadata/'>Raindrop-specific metadata</a>.</p>

<p>You now have everything in place and properly configured to build your Raindrop. Hooray!</p>

<h2 id='two_different_kinds_of_raindrops'>Two Different Kinds of Raindrops</h2>

<p>We already talked about two Raindrops, Photoshop and Screenshots, remember? Well, it turns out that those two Raindrops represent two different kinds of Raindrops. The Photoshop one uploads content as soon as the user <strong>triggers</strong> it using the hotkey. The Screenshot Raindrop, on the other hand, does upload <strong>without being triggered</strong> by the hotkey as soon as it detects a new screenshot. As the latter one is constantly working in the background, we decided to label all Raindrops of that kind as <em>downpour</em>. Fancy, eh?</p>

<p>Obviously, the way you implement those two Raindrops differs. But never fear! We’ll walk you through.</p>

<h3 id='nondownpour_raindrops'>Non-downpour Raindrops</h3>

<p>Non-downpour Raindrops are fairly simple to implement. The <code>CLRaindopProtocol</code> protocol defines the <code>pasteboardNameForTriggeredRaindrop</code> method which gets called as soon as the user triggers your Raindrop. Your job is it to create a new <code>NSPasteboard</code> object, add content to it and return its name. Here’s a quick example:</p>

<pre><code>@implementation MyClass

- (NSString *)pasteboardNameForTriggeredRaindrop
{
    // Assuming that doSomething returns the path to a file
    NSString *path = [self doSomething];
    NSURL *fileURL = [NSURL fileURLWithPath:path];
    
    // Create pasteboard with unique name
    NSPasteboard *pasteboard = [NSPasteboard pasteboardWithUniqueName];
    
    // Add an item
    NSPasteboardItem *item = [[NSPasteboardItem alloc] init];
    [item setString:[fileURL absoluteString] forType:(NSString *)kUTTypeFileURL];
    [pasteboard writeObjects:[NSArray arrayWithObject:item]];
    [item release];
    
    // Return the pasteboard name
    return [pasteboard name];
}

@end</code></pre>

<p>Non-downpour Raindrops always have a target bundle identifier, which you <strong>must</strong> define using <a href='/raindrops-metadata'>Raindrop metadata</a>. CloudApp uses this bundle identifier to determine which Raindrop to invoke if the user hits the hotkey. For example, if the user triggers a Raindrop while Finder is the active application, it triggers the Raindrop that defines <code>com.apple.Finder</code> as its target bundle identifier. CloudApp also takes care of launching end terminating your Raindrop if the target application of your Raindrop launches or terminates.</p>

<h3 id='downpour_raindrops'>Downpour Raindrops</h3>

<p>Implementing a downpour Raindrop requires a bit more work but still, CloudApp is doing nearly all the heavy lifting for you. In contrast to non-downpour Raindrops, you are now responsible to trigger an upload. You therefore need some kind of contact person who you can tell <em>“Hey there, I have something to upload for you!”</em>. That’s where the <code>initWithHelper:</code> method comes in handy. The <code>helper</code> object implements <code>CLRaindropHelperProtocol</code> and responds to <code>handlePasteboardWithName:</code>. You can call this method at any given time to trigger an upload. As you probably already figured, it is therefore a good idea to keep a reference to the <code>helper</code> object for later.</p>

<p>The rest of the implementation is almost similar to the non-downpour one. Once your Raindrop decides to upload something, it creates a new <code>NSPasteboard</code> object, adds content and tells the helper the name of that pasteboard. Again, here’s a quick example:</p>

<pre><code>@implementation MyClass

- (id)initWithHelper:(id &lt;CLRaindropHelperProtocol&gt;)helper
{
    if ((self = [super init])) {
        // Assuming that the MyClass @interface defines an _helper instance variable
        _helper = [helper retain];
    }
    return self;
}

- (void)eventCallback:(NSString *)path
{
    // Something happend and you detected that this is of interest for your raindrop
    // Assuming that your raindrop passes the path of an existing file in
    NSURL *fileURL = [NSURL fileURLWithPath:path];
    
    // Create pasteboard with unique name
    NSPasteboard *pasteboard = [NSPasteboard pasteboardWithUniqueName];
    
    // Add an item
    NSPasteboardItem *item = [[NSPasteboardItem alloc] init];
    [item setString:[fileURL absoluteString] forType:(NSString *)kUTTypeFileURL];
    [pasteboard writeObjects:[NSArray arrayWithObject:item]];
    [item release];
    
    // Trigger upload
    [_helper handlePasteboardWithName:[pasteboard name]];
}

- (void)dealloc
{
    [_helper release];
    [super dealloc];
}

@end</code></pre>

<p>You <strong>must</strong> explicitly declare a Raindrop as downpour and describe what the downpour action does using <a href='/raindrops-metadata'>Raindrop metadata</a>.</p>

<h2 id='supported_pasteboard_content'>Supported Pasteboard Content</h2>

<p>As you’ve seen, Raindrops make heavy use of <code>NSPasteboard</code> to exchange content with CloudApp. The following section lists all content types that are currently supported by CloudApp.</p>

<ul>
<li>One or more items that conform to <code>kUTTypeFileURL</code> and reference an existing file for file uploads</li>

<li>Exactly one item that conforms to <code>kUTTypeImage</code> and contains image data for an image file upload</li>

<li>Exactly one item that conforms to <code>kUTTypeURL</code> and contains an URL for a bookmark</li>

<li>Exactly one item that conforms to <code>kUTTypeText</code> and contains text for a text file upload</li>
</ul>

<p>If the pasteboard item references an existing file (which is the case for <code>kUTTypeFileURL</code>), CloudApp uses the filename to name the upload. If the item contains only content data (which is the case for everything else), you’ll have to pass along a filename using <code>@&quot;public.url-name&quot;</code> as the pasteboard item type.</p>

<h2 id='more_examples'>More Examples</h2>

<p>We’ve open-sourced all our <a href='https://github.com/cloudapp/raindrops'>Raindrops on github</a>. Go ahead and use them to get an idea how a complete Raindrop implementation looks like!</p>
        </section>

        <aside class="col col_4" id="sidebar">
          
            <section class="categories">
              <h3>Basics</h3>

              <ul>
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/common-errors" id="basics">Common Errors</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/usage" id="basics">Usage</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            </section>
          
            <section class="categories">
              <h3>Wrapper</h3>

              <ul>
                
                  
                
                  
                
                  
                    
                      <li><a href="/c-sharp-wrapper" id="wrapper">C#</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/java-wrapper" id="wrapper">Java</a></li>
                    
                  
                
                  
                
                  
                    
                      <li><a href="/objective-c-wrapper" id="wrapper">Objective-C</a></li>
                    
                  
                
                  
                    
                      <li><a href="/perl-wrapper" id="wrapper">Perl</a></li>
                    
                  
                
                  
                    
                      <li><a href="/php-wrapper" id="wrapper">PHP</a></li>
                    
                  
                
                  
                    
                      <li><a href="/python-wrapper" id="wrapper">Python</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/ruby-wrapper" id="wrapper">Ruby</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            </section>
          
            <section class="categories">
              <h3>Account</h3>

              <ul>
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/change-default-security" id="account">Change Default Security</a></li>
                    
                  
                
                  
                    
                      <li><a href="/change-email" id="account">Change Email</a></li>
                    
                  
                
                  
                    
                      <li><a href="/change-password" id="account">Change Password</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/forgot-password" id="account">Forgot Password</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/register" id="account">Register</a></li>
                    
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/set-custom-domain" id="account">Set Custom Domain</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/view-account-details" id="account">View Account Details</a></li>
                    
                  
                
                  
                    
                      <li><a href="/view-account-stats" id="account">View Account Stats</a></li>
                    
                  
                
                  
                
                  
                
              </ul>
            </section>
          
            <section class="categories">
              <h3>Items</h3>

              <ul>
                
                  
                    
                      <li><a href="/bookmark-link" id="items">Bookmark Link</a></li>
                    
                  
                
                  
                    
                      <li><a href="/bookmark-multiple-links" id="items">Bookmark Multiple Links</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/change-security-of-item" id="items">Change Security Of Item</a></li>
                    
                  
                
                  
                
                  
                    
                      <li><a href="/delete-item" id="items">Delete Item</a></li>
                    
                  
                
                  
                    
                      <li><a href="/empty-trash" id="items">Empty Trash</a></li>
                    
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/list-items" id="items">List Items</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/recover-deleted-item" id="items">Recover Deleted Item</a></li>
                    
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/rename-item" id="items">Rename Item</a></li>
                    
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/streaming-items" id="items">Stream Items</a></li>
                    
                  
                
                  
                    
                      <li><a href="/upload-file" id="items">Upload File</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/view-item" id="items">View Item</a></li>
                    
                  
                
              </ul>
            </section>
          
            <section class="categories">
              <h3>Gift cards</h3>

              <ul>
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/redeem-gift-card" id="gift_cards">Redeem Gift Card</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li><a href="/view-gift-card" id="gift_cards">View Gift Card Details</a></li>
                    
                  
                
                  
                
              </ul>
            </section>
          
            <section class="categories">
              <h3>Mac</h3>

              <ul>
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                      <li>Raindrops</li>
                    
                  
                
                  
                    
                      <li><a href="/raindrops-metadata" id="mac">Raindrops Metadata</a></li>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            </section>
          
        </aside>
      </div>

      <footer class="row" id="footer">
        <div class="col col_8">
          <ul>
            <li>&copy; 2010 Linebreak S.L.</li>
            <li>Powered by <a href="http://heroku.com/">Heroku</a></li>
            <li><a href="http://help.getcloud.me/kb/company/contact/">Contact</a></li>
            <li><a href="http://help.getcloud.me/kb/site-policy/terms-of-service/">Terms</a></li>
            <li><a href="http://help.getcloud.me/kb/site-policy/privacy-policy/">Privacy</a></li>
            <li><a href="/">Developer</a></li>
          </ul>
        </div>

        <div class="col col_4">
          <ul class="right">
            <li><a href='http://www.twitter.com/getcloudapp'>Twitter</a></li>
          </ul>
        </div>
      </footer>
    </div>
  </body>
</html>
